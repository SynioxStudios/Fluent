local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

local Fluent = {}

function Fluent:CreateWindow(Config)
    local Title = Config.Title or "Syniox Hub"
    local SubTitle = Config.SubTitle or "Version 1.0"
    local MinimizeKey = Config.MinimizeKey or Enum.KeyCode.RightControl

    local SynioxGui = Instance.new("ScreenGui")
    SynioxGui.Name = "SynioxHub_Final"
    SynioxGui.Parent = CoreGui
    SynioxGui.ResetOnSpawn = false

    -- MEŞHUR YUVARLAK LOGO (LAUNCHER)
    local Launcher = Instance.new("ImageButton")
    Launcher.Name = "Launcher"
    Launcher.Parent = SynioxGui
    Launcher.Size = UDim2.new(0, 60, 0, 60)
    Launcher.Position = UDim2.new(0.02, 0, 0.45, 0)
    Launcher.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    Launcher.BackgroundTransparency = 0.2
    Launcher.Image = "https://www.roblox.com/Thumbs/Asset.ashx?width=420&height=420&assetId=129903125132641"
    Launcher.ZIndex = 100
    
    local LauncherCorner = Instance.new("UICorner")
    LauncherCorner.CornerRadius = UDim.new(0, 30)
    LauncherCorner.Parent = Launcher

    -- ANA ÇERÇEVE (MAINFRAME)
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = SynioxGui
    MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    MainFrame.Size = UDim2.new(0, 400, 0, 420)
    MainFrame.Position = UDim2.new(0.5, -325, 0.5, -210)
    MainFrame.BorderSizePixel = 0
    MainFrame.Visible = false
    MainFrame.ClipsDescendants = true
    
    local MainCorner = Instance.new("UICorner")
    MainCorner.CornerRadius = UDim.new(0, 8)
    MainCorner.Parent = MainFrame

    -- LAUNCHER TIKLAMA FONKSİYONU
    Launcher.MouseButton1Click:Connect(function()
        MainFrame.Visible = not MainFrame.Visible
    end)

    -- ÜST BAR (TOPBAR)
    local TopBar = Instance.new("Frame")
    TopBar.Name = "TopBar"
    TopBar.Parent = MainFrame
    TopBar.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    TopBar.Size = UDim2.new(1, 0, 0, 40)
    
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Parent = TopBar
    TitleLabel.Size = UDim2.new(1, -70, 1, 0)
    TitleLabel.Position = UDim2.new(0, 15, 0, 0)
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.Text = Title .. " | " .. SubTitle
    TitleLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextSize = 14
    TitleLabel.BackgroundTransparency = 1

    -- SOL PANEL
    local LeftPanel = Instance.new("Frame")
    LeftPanel.Name = "LeftPanel"
    LeftPanel.Parent = MainFrame
    LeftPanel.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    LeftPanel.Size = UDim2.new(0, 150, 1, -40)
    LeftPanel.Position = UDim2.new(0, 0, 0, 40)
    
    local TabHolder = Instance.new("ScrollingFrame")
    TabHolder.Parent = LeftPanel
    TabHolder.Size = UDim2.new(1, 0, 1, -10)
    TabHolder.Position = UDim2.new(0, 0, 0, 5)
    TabHolder.BackgroundTransparency = 1
    TabHolder.ScrollBarThickness = 0

    local TabList = Instance.new("UIListLayout")
    TabList.Parent = TabHolder
    TabList.Padding = UDim.new(0, 5)
    TabList.HorizontalAlignment = Enum.HorizontalAlignment.Center

    local ContentHolder = Instance.new("Frame")
    ContentHolder.Parent = MainFrame
    ContentHolder.Position = UDim2.new(0, 160, 0, 50)
    ContentHolder.Size = UDim2.new(1, -170, 1, -60)
    ContentHolder.BackgroundTransparency = 1

    -- SÜRÜKLENEBİLİRLİK (DRAGGABLE)
    local dragging, dragStart, startPos
    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true dragStart = input.Position startPos = MainFrame.Position
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
    end)

    local Window = { Tabs = {}, FirstTab = nil }

    function Window:AddTab(tConfig)
        local TabPage = Instance.new("ScrollingFrame")
        TabPage.Parent = ContentHolder
        TabPage.Size = UDim2.new(1, 0, 1, 0)
        TabPage.BackgroundTransparency = 1
        TabPage.Visible = false
        TabPage.ScrollBarThickness = 0

        local PageLayout = Instance.new("UIListLayout")
        PageLayout.Parent = TabPage
        PageLayout.Padding = UDim.new(0, 8)

        local TabButton = Instance.new("TextButton")
        TabButton.Parent = TabHolder
        TabButton.Size = UDim2.new(0, 135, 0, 35)
        TabButton.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        TabButton.Text = tConfig.Title
        TabButton.TextColor3 = Color3.fromRGB(180, 180, 180)
        TabButton.Font = Enum.Font.Gotham
        TabButton.TextSize = 13
        
        local BtnCorner = Instance.new("UICorner")
        BtnCorner.CornerRadius = UDim.new(0, 6)
        BtnCorner.Parent = TabButton

        if not Window.FirstTab then
            Window.FirstTab = TabPage
            TabPage.Visible = true
            TabButton.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
            TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        end

        TabButton.MouseButton1Click:Connect(function()
            for _, v in pairs(ContentHolder:GetChildren()) do v.Visible = false end
            for _, v in pairs(TabHolder:GetChildren()) do 
                if v:IsA("TextButton") then 
                    v.BackgroundColor3 = Color3.fromRGB(25, 25, 35) 
                    v.TextColor3 = Color3.fromRGB(180, 180, 180) 
                end
            end
            TabPage.Visible = true
            TabButton.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
            TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        end)

        local Tab = {}

        -- MYSTERY HUB STİLİ TOGGLE
        function Tab:AddToggle(Name, Callback)
            local Container = Instance.new("Frame")
            Container.Parent = TabPage
            Container.Size = UDim2.new(1, -5, 0, 45)
            Container.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
            
            local Corner = Instance.new("UICorner")
            Corner.CornerRadius = UDim.new(0, 6)
            Corner.Parent = Container

            local Label = Instance.new("TextLabel")
            Label.Parent = Container
            Label.Size = UDim2.new(1, -60, 1, 0)
            Label.Position = UDim2.new(0, 12, 0, 0)
            Label.Text = Name
            Label.TextColor3 = Color3.fromRGB(210, 210, 210)
            Label.Font = Enum.Font.Gotham
            Label.TextSize = 13
            Label.BackgroundTransparency = 1
            Label.TextXAlignment = Enum.TextXAlignment.Left

            local Switch = Instance.new("TextButton")
            Switch.Parent = Container
            Switch.Size = UDim2.new(0, 42, 0, 22)
            Switch.Position = UDim2.new(1, -52, 0.5, -11)
            Switch.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
            Switch.Text = ""
            
            local SCorner = Instance.new("UICorner")
            SCorner.CornerRadius = UDim.new(0, 11)
            SCorner.Parent = Switch

            local Circle = Instance.new("Frame")
            Circle.Parent = Switch
            Circle.Size = UDim2.new(0, 18, 0, 18)
            Circle.Position = UDim2.new(0, 2, 0, 2)
            Circle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            
            local CCorner = Instance.new("UICorner")
            CCorner.CornerRadius = UDim.new(0, 9)
            CCorner.Parent = Circle

            local toggled = false
            Switch.MouseButton1Click:Connect(function()
                toggled = not toggled
                local targetPos = toggled and UDim2.new(1, -20, 0, 2) or UDim2.new(0, 2, 0, 2)
                local targetColor = toggled and Color3.fromRGB(70, 130, 180) or Color3.fromRGB(50, 50, 70)
                
                TweenService:Create(Circle, TweenInfo.new(0.2), {Position = targetPos}):Play()
                TweenService:Create(Switch, TweenInfo.new(0.2), {BackgroundColor3 = targetColor}):Play()
                Callback(toggled)
            end)
        end

        function Tab:AddButton(Text, Callback)
            local Btn = Instance.new("TextButton")
            Btn.Parent = TabPage
            Btn.Size = UDim2.new(1, -5, 0, 40)
            Btn.BackgroundColor3 = Color3.fromRGB(41, 74, 122)
            Btn.Text = Text
            Btn.TextColor3 = Color3.fromRGB(255, 255, 255)
            Btn.Font = Enum.Font.GothamBold
            Btn.TextSize = 14
            
            local BCorner = Instance.new("UICorner")
            BCorner.CornerRadius = UDim.new(0, 6)
            BCorner.Parent = Btn
            
            Btn.MouseButton1Click:Connect(Callback)
        end

        return Tab
    end
    return Window
end

return Fluent
